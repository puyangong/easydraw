*{box-sizing:border-box}html,body{margin:0;height:100%;overflow:hidden;font-family:system-ui,-apple-system,Segoe UI,Roboto}
#canvas{position:fixed;inset:0;touch-action:none;background:#fff}
.floating{position:fixed;top:12px;right:12px;display:flex;gap:8px;z-index:10}
.floating button{padding:8px 12px;border:1px solid #ccc;background:#f7f7f7;border-radius:6px;touch-action:manipulation;-webkit-tap-highlight-color:transparent;user-select:none}
.floating button:disabled{opacity:.5;cursor:not-allowed}
.toolbar{position:fixed;left:0;right:0;bottom:0;background:#f0f0f0;border-top:1px solid #ddd;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:8px;gap:8px;z-index:9}
.tools{display:flex;flex-wrap:wrap;gap:6px}
.tools button{padding:8px 10px;border:1px solid #ccc;background:#fff;border-radius:6px}
.tools button.active{border-color:#4d90fe;background:#eaf3ff;box-shadow:0 0 0 2px rgba(77,144,254,.18) inset}
.colors{display:flex;align-items:center;gap:10px}
.colors label{display:flex;align-items:center;gap:6px;background:#fff;border:1px solid #ccc;border-radius:6px;padding:4px 6px}
.presets{display:flex;align-items:center;gap:6px}
.preset{width:22px;height:22px;border:1px solid #ccc;border-radius:4px;padding:0}
.preset[title="#FFFFFF"]{border-color:#aaa}
.overlay.hidden{display:none}
.edit-btn{position:absolute;padding:6px 8px;border:1px solid #666;background:#ffd;border-radius:8px;font-size:14px;pointer-events:auto;touch-action:none;-ms-touch-action:none}
.edit-btn.move{left:0;top:0}
.edit-btn.delete{right:0;top:0}
.edit-btn.resize{right:0;bottom:0}
#edit-overlay{position:absolute;z-index:11;pointer-events:none}
#line-points{position:absolute;z-index:12;pointer-events:none}
.point{position:absolute;width:18px;height:18px;border-radius:50%;background:#00aaff;border:2px solid #005f88;box-shadow:0 0 4px rgba(0,0,0,.2);pointer-events:auto;touch-action:none;-ms-touch-action:none}
#line-pm{display:none}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center;z-index:20}
.modal.hidden{display:none}
.modal-content{width:min(640px,92vw);background:#fff;border-radius:10px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.25)}
.modal .row{display:flex;align-items:center;gap:10px;margin-top:8px}
.modal textarea{width:100%;resize:vertical}
.modal .actions{display:flex;justify-content:flex-end;gap:8px;margin-top:12px}
@media (max-width:720px){.floating{top:8px;right:8px}.floating button{padding:6px 10px;min-height:44px;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.tools button{padding:6px 8px}.colors{flex-wrap:wrap;gap:6px}.preset{width:20px;height:20px}.edit-btn{font-size:12px;padding:5px 7px}}
.floating button#clearBtn {
  background: #ffcccc;
  color: #cc0000;
  border-color: #cc0000;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}